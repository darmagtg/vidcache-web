#!/usr/bin/php
<?php
require('boot.php');

use \Vidcache\VC;

//register stream wrapper
VC::register();

$opts = getopt('vD',array('verbose','debug'));
if(mda_get($opts,'D') !== false && mda_get($opts,'debug') !== false)
	define('LOG_QUIET',true);
$args = array();
foreach($argv as $arg){ if(substr($arg,0,1) !== '-') $args[] = $arg; }
if(count($args) != 2)
	throw new Exception('Provide a target to remove');
$target = $args[1];
if(!(strpos($target,VC::getPrefix()) === 0))
	throw new Exception('Use normal rm to remove local files');
if(!VC::unlink($target))
	throw new Exception('Failed to remove file '.$target);
if(array_key_exists('v',$opts) || array_key_exists('verbose',$opts))
	printf("removed `%s'\n",$target);
